<!DOCTYPE html>
<html>
<head>
  <title>Chocolate Day Challenge üç´üíñ</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: linear-gradient(to top, #4a148c, #880e4f);
      font-family: 'Comic Sans MS', cursive;
      text-align: center;
      color: white;
      touch-action: none; /* Prevent scrolling on mobile */
    }

    h1 { margin: 10px 0 5px; font-size: 24px; }

    #scoreBoard {
      font-size: 18px;
    }

    #message {
      font-size: 16px;
      color: #ffd6ff;
      height: 25px;
    }

    #gameArea {
      position: relative;
      width: 100%;
      height: 70vh;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.05);
    }

    canvas {
      display: block;
      width: 100%;
      height: 100%;
    }

    #finalScreen {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.9);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      padding: 20px;
      z-index: 10;
    }

    #finalScreen h2 {
      font-size: 28px;
      color: #ff80ab;
    }

    #finalScreen p {
      font-size: 20px;
      max-width: 500px;
    }

    button {
      padding: 10px 20px;
      font-size: 18px;
      border: none;
      border-radius: 8px;
      background: #ff4081;
      color: white;
      cursor: pointer;
      margin-top: 15px;
    }
  </style>
</head>
<body>

<h1>üç´ Catch 20 Chocolates Challenge üç´</h1>
<div id="scoreBoard">Caught: 0 / 20</div>
<div id="message">Use ‚¨ÖÔ∏è ‚û°Ô∏è or Slide to move</div>

<div id="gameArea">
  <canvas id="gameCanvas"></canvas>
  <div id="finalScreen">
    <h2 id="finalTitle"></h2>
    <p id="rewardText"></p>
    <button onclick="location.reload()">Play Again üíï</button>
  </div>
</div>

<script>
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");
  const scoreBoard = document.getElementById("scoreBoard");
  const messageDisplay = document.getElementById("message");
  const finalScreen = document.getElementById("finalScreen");
  const finalTitle = document.getElementById("finalTitle");
  const rewardText = document.getElementById("rewardText");

  let caught = 0;
  let dropped = 0;
  const totalChocolates = 20;
  let chocolates = [];
  let isGameOver = false;

  const basket = {
    x: 0,
    y: 0,
    width: 80,
    height: 60,
    emoji: "üß∫"
  };

  function resize() {
    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;
    basket.y = canvas.height - basket.height - 10;
    basket.x = (canvas.width - basket.width) / 2;
  }
  window.addEventListener("resize", resize);
  resize();

  // Desktop Controls
  document.addEventListener("keydown", (e) => {
    if (e.key === "ArrowLeft") basket.x = Math.max(0, basket.x - 40);
    if (e.key === "ArrowRight") basket.x = Math.min(canvas.width - basket.width, basket.x + 40);
  });

  // Mobile/Touch/Mouse Controls
  function handleMove(clientX) {
    const rect = canvas.getBoundingClientRect();
    let x = clientX - rect.left - basket.width / 2;
    basket.x = Math.max(0, Math.min(canvas.width - basket.width, x));
  }

  canvas.addEventListener("mousemove", (e) => handleMove(e.clientX));
  canvas.addEventListener("touchmove", (e) => {
    handleMove(e.touches[0].clientX);
    e.preventDefault();
  }, { passive: false });

  class Chocolate {
    constructor() {
      this.width = 40;
      this.height = 40;
      this.x = Math.random() * (canvas.width - this.width);
      this.y = -this.height;
      this.speed = 3 + Math.random() * 4;
      this.emoji = "üç´";
    }

    update() {
      this.y += this.speed;
      
      // Collision check
      if (
        this.y + this.height >= basket.y &&
        this.x + this.width > basket.x &&
        this.x < basket.x + basket.width &&
        this.y < basket.y + basket.height
      ) {
        caught++;
        scoreBoard.innerText = `Caught: ${caught} / ${totalChocolates}`;
        messageDisplay.innerText = "Sweet catch! üç´üíï";
        return true; // Caught
      }

      if (this.y > canvas.height) {
        return true; // Dropped
      }
      return false;
    }

    draw() {
      ctx.font = "40px serif";
      ctx.textAlign = "center";
      ctx.textBaseline = "top";
      ctx.fillText(this.emoji, this.x + this.width/2, this.y);
    }
  }

  function spawnChocolate() {
    if (dropped < totalChocolates && !isGameOver) {
      chocolates.push(new Chocolate());
      dropped++;
      setTimeout(spawnChocolate, 800 + Math.random() * 400);
    }
  }

  function endGame() {
    isGameOver = true;
    finalScreen.style.display = "flex";
    finalTitle.innerText = `You caught ${caught} out of ${totalChocolates}! üç´`;

    let reward = "";
    if (caught >= 15) {
      reward = "üèÜ Chocolate Master Priti! Reward: Unlimited hugs + a big Dairy Milk treat (and gift to your boyfriend)üòòüíñ";
    } else if (caught >= 10) {
      reward = "ü•∞ Sweet Lover Priti! Reward: One movie night + chocolate date üçøüç´";
    } else if (caught >= 5) {
      reward = "üòä Cute Try Priti! Reward: One tight hug and a sweet smile üíï";
    } else {
      reward = "üòú Oops Priti! You owe me chocolates now! But you still get a smile üòÑüç´";
    }
    rewardText.innerText = reward;
  }

  function update() {
    if (isGameOver) return;

    chocolates = chocolates.filter(c => !c.update());

    if (dropped === totalChocolates && chocolates.length === 0) {
      endGame();
    }
  }

  function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw Basket
    ctx.font = "60px serif";
    ctx.textAlign = "center";
    ctx.textBaseline = "top";
    ctx.fillText(basket.emoji, basket.x + basket.width/2, basket.y);

    // Draw Chocolates
    chocolates.forEach(c => c.draw());

    update();
    requestAnimationFrame(draw);
  }

  spawnChocolate();
  draw();
</script>

</body>
</html>